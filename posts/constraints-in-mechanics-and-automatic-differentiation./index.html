<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Lagrange Multipliers, Mechanics and Automatic Differentiation. &#183; Carlos's Website</title>
<meta name=title content="Lagrange Multipliers, Mechanics and Automatic Differentiation. &#183; Carlos's Website"><meta name=description content="A little example "><meta name=keywords content="Autodiff,Pyodide,Mechanics,WebGL,threejs,"><link rel=canonical href=https://calugo.github.io/posts/constraints-in-mechanics-and-automatic-differentiation./><link type=text/css rel=stylesheet href=/css/main.bundle.min.665e57a6b6a7363e73b154576f2b6058a2fdb0af8120c75b50739753742cd1d7e0a40adb8b79412873c65da39db636d058c97394138a1307523b63c58558a9ff.css integrity="sha512-Zl5XpranNj5zsVRXbytgWKL9sK+BIMdbUHOXU3Qs0dfgpArbi3lBKHPGXaOdtjbQWMlzlBOKEwdSO2PFhVip/w=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.700c68ced6ecd1ce7e26bb8477435b70302e309815080ee5975c308b2030021fb2febf06550bed73e27b5c8feac2526b9061f74d46ff72d939dad11fcabc5963.js integrity="sha512-cAxoztbs0c5+JruEd0NbcDAuMJgVCA7ll1wwiyAwAh+y/r8GVQvtc+J7XI/qwlJrkGH3TUb/ctk52tEfyrxZYw==" data-copy data-copied></script><script src=/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://calugo.github.io/posts/constraints-in-mechanics-and-automatic-differentiation./"><meta property="og:site_name" content="Carlos's Website"><meta property="og:title" content="Lagrange Multipliers, Mechanics and Automatic Differentiation."><meta property="og:description" content="A little example"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-24T00:00:00+00:00"><meta property="article:tag" content="Autodiff"><meta property="article:tag" content="Pyodide"><meta property="article:tag" content="Mechanics"><meta property="article:tag" content="WebGL"><meta property="article:tag" content="Threejs"><meta property="og:image" content="https://calugo.github.io/posts/constraints-in-mechanics-and-automatic-differentiation./featured.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://calugo.github.io/posts/constraints-in-mechanics-and-automatic-differentiation./featured.gif"><meta name=twitter:title content="Lagrange Multipliers, Mechanics and Automatic Differentiation."><meta name=twitter:description content="A little example"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Lagrange Multipliers, Mechanics and Automatic Differentiation.","headline":"Lagrange Multipliers, Mechanics and Automatic Differentiation.","description":"A little example ","inLanguage":"en","url":"https:\/\/calugo.github.io\/posts\/constraints-in-mechanics-and-automatic-differentiation.\/","author":{"@type":"Person","name":"Carlos A. Lugo Ph.D."},"copyrightYear":"2025","dateCreated":"2025-04-24T00:00:00\u002b00:00","datePublished":"2025-04-24T00:00:00\u002b00:00","dateModified":"2025-04-24T00:00:00\u002b00:00","keywords":["Autodiff","Pyodide","Mechanics","WebGL","threejs"],"mainEntityOfPage":"true","wordCount":"1317"}]</script><meta name=author content="Carlos A. Lugo Ph.D."><link href=https://www.hackster.io/kupkasmale rel=me><link href=https://github.com/calugo rel=me><link href=https://gitlab.com/calugo rel=me><link href=https://linkedin.com/in/carlos-a-lugo-velez rel=me><link href=https://orcid.org/0000-0003-0095-566X rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link type=text/css rel=stylesheet href=/lib/katex/katex.min.68e17230ccd917b97b7a2def38a8108918599d8aa4f580bfb8cce5e13d23e4de43dcaba5f9000553cb2c10d0d1300aabfe5c433a3305ebd752609f0762a63e59.css integrity="sha512-aOFyMMzZF7l7ei3vOKgQiRhZnYqk9YC/uMzl4T0j5N5D3Kul+QAFU8ssENDRMAqr/lxDOjMF69dSYJ8HYqY+WQ=="><script defer src=/lib/katex/katex.min.50f14e69d6a8da7128ae3b63974c544ed377c36d096b5e3750f114e84c89d668b9301d9b0ed3248969aa183aa2e3bc4d2c1e73d5dcb7d462890c45a18d424589.js integrity="sha512-UPFOadao2nEorjtjl0xUTtN3w20Ja143UPEU6EyJ1mi5MB2bDtMkiWmqGDqi47xNLB5z1dy31GKJDEWhjUJFiQ=="></script><script defer src=/lib/katex/auto-render.min.6095714e3aadb63b14ddc4af69346ab12974c1b460654345f8d1860a0b68fcc51b22f68b757433193090bb80afc8965b65cb607e5541d0f5f0f4b2e64d69b9ff.js integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" onload=renderMathInElement(document.body)></script><script defer src=/lib/packery/packery.pkgd.min.js integrity></script><script type=text/javascript src=/js/shortcodes/gallery.min.9b4cb28f931ed922c26fb9b2510c2debb370f6a63305050c2af81740b2919883715e24efbbdf3a081496718ec751df3a72729d4d0bc71d6071297563a97ce1ee.js integrity="sha512-m0yyj5Me2SLCb7myUQwt67Nw9qYzBQUMKvgXQLKRmINxXiTvu986CBSWcY7HUd86cnKdTQvHHWBxKXVjqXzh7g=="></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Carlos&rsquo;s Website</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Posts>Projects</p></a><a href=/about/bio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title="About me">About</p></a><a href=/experience/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Resume>Experience</p></a><div class="ltr:mr-14 rtl:ml-14 flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400" style=margin-right:5px><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Posts>Projects</p></a></li><li class=mt-1><a href=/about/bio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="About me">About</p></a></li><li class=mt-1><a href=/experience/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Resume>Experience</p></a></li></ul></div></label></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/posts/constraints-in-mechanics-and-automatic-differentiation./featured_hu_fac77e34c00f6569.gif)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Lagrange Multipliers, Mechanics and Automatic Differentiation.</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><span>1317 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">7 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><div style=text-align:justify>Classical mechanics of particles is a subject which serves as gateway to concepts, tools and
techniques which are common currency in every field which aims to describe dynamical phenomena, as well as in contemporary data science and machine learning
which rely on finding solutions of optimization problems.<p>A prototypical optimization is that of the motion of a particle subjected to constraints due to a physical barrier (see the movie below), where a mass under the action of gravity moves over a surface.</p></div><p><div id=gallery-bd69d1ddc0649d65db1586038a682053 class=gallery><img src=gallery/Par2.gif class=grid-w100></div><div style=text-align:justify><b><i>Solution obtained with the implementation described in this post. In this example, a particle with an initial potential energy moves over the surface of a paraboloid. The code to solve this type of problems can be found <a href=https://github.com/calugo/Lagrange-Multipliers-with-autodiff target=_blank>here</a>.</i></b></p><div style=text-align:justify>In this post I discuss how to solve the type of problem mentioned above using the Lagrange multipliers method. First, I briefly present the maths and then I describe how to use automatic differentiation to numerically solve the equations using the Runge-Kutta method.</div><div style=text-align:justify><p>As with almost every post, I also share an interactive implementation of the method. On this occasion, It is built using <a href=https://threejs.org/>threejs</a> and <a href=https://pyodide.org/en/stable/#>pyodide</a>.</p></div><h3 class="relative group">Interactive Demo:<div id=interactive-demo class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#interactive-demo aria-label=Anchor>#</a></span></h3><div style=text-align : center><iframe src=https://calugo.github.io/Lagrange-Multipliers-with-autodiff/ style="border:3px dotted #000;width:100%;height:500px"></iframe>
<b><i>Online implementation using Pyodide and Threejs. Of course, it works better on a <a href=https://calugo.github.io/Lagrange-Multipliers-with-autodiff/ target=_blank>tab of its own!</a> Below I describe some details on how to make your own. For best result, make sure to check the <a href=https://pyodide.org/en/stable/#>Pyodide</a> documentation. In this demo, once you have set the initial position xo and yo and the surface with parameters A,B. click on the <b>Run</b> button and wait until the <b>Plot</b> is enabled to plot the trajectory!. You can move the scene around and zoom, with the mouse or touch gestures.</i></b></div><h2 class="relative group">Mechanics of a particle with constraints: The Lagrange multipliers method.<div id=mechanics-of-a-particle-with-constraints-the-lagrange-multipliers-method class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#mechanics-of-a-particle-with-constraints-the-lagrange-multipliers-method aria-label=Anchor>#</a></span></h2><div style=text-align:justify><p>In rectangular coordinates
\( r=(x,y,z )\) the motion of a particle of mass \( m \) under the effect of gravity has a Lagrangian function: $$ L_o = \frac{1}{2} m \dot{r}^2 + m g z \quad(1)$$</p><p>If the particle is constrained to move over a surface such an inclined plane or another landscape which can be described by a function \( z = f(x,y) \). The Lagrangian \( (1) \) needs to be complemented with a contribution for the constraint as:</p><p>$$L = L_o + \lambda(z-f(x,y)) \quad(2)$$</p><p>Where \( \lambda \) is a constant called the lagrange multiplier, which needs to be determined to ensure the constrained is fulfilled. The equations of motion obtained by optimizing \( (2) \) are:
$$m\ddot{x} = -\lambda f_x\quad(3)$$
$$m\ddot{y} = -\lambda f_y \quad(4)$$
$$m\ddot{z} = -mg + \lambda\quad(5)$$</p><p>Where the indices in \( f\) stand for the partial derivative with respect to that variable. The system \( (3)-(5)\) needs to be complemented with the constraint equation
obtained differentiating \( z \) respect to time twice:</p><p>$$\ddot{z} =(\dot{x}^2 f_{xx} + \dot{y}^2f_{yy})+\dot{x}\dot{y}(f_{xy}+f_{yx})+(\ddot{x}f_x+\dot{y}f_y)\quad(6)$$</p><p>Solving for \( \lambda \) using \( (3)-(6)\) gives:</p><p>$$\lambda = \frac{m}{1+f_x^2+f_y^2}(g + \dot{x}^2f_{xx} + \dot{y}^2f_{yy} + \dot{x}\dot{y}(f_{xy}+f_{yx}))\quad(7) $$</p><p>Which leads to the equations of motion:</p><p>$$\ddot{x}=-\frac{g + \dot{x}^2f_{xx} + \dot{y}^2f_{yy} + \dot{x}\dot{y}(f_{xy}+f_{yx}) }{1+f_x^2+f_y^2} f_x \quad(8)$$
$$\ddot{y}=-\frac{g+ \dot{x}^2f_{xx} + \dot{y}^2f_{yy} + \dot{x}\dot{y}(f_{xy}+f_{yx})}{1+f_x^2+f_y^2} f_y \quad(9)$$
$$\ddot{z}=-g + \frac{g+\dot{x}^2f_{xx} + \dot{y}^2f_{yy} + \dot{x}\dot{y}(f_{xy}+f_{yx})}{1+f_x^2+f_y^2} \quad(10)$$</p><p>There is a lot that can be said about these equations, which is of course beyond the scope of this little blog, however, it is worth noticing that in general these constitute a nonlinear system, which can&rsquo;t be solved analytically, except for a few simple cases, such as an inclined plane. The system can be numerically solved using a general integration scheme such as the Runge-Kutta method, provided we can efficiently compute the derivatives of the constraint.</p></div><h1 class="relative group">Runge-Kutta integration.<div id=runge-kutta-integration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#runge-kutta-integration aria-label=Anchor>#</a></span></h1><div style=text-align:justify><p>The numerical solution of a system of the form \(\dot{ \bf{x} }= \bf{F(x,t)} \) is obtained by:</p><p>$${\bf{x}}_{n+1} = {\bf{x}}_n + (1/6)( {\bf{k}}_1 + 2 {\bf{k}}_2 + 2 {\bf{k}}_3 + {\bf{k}}_4 )\quad(11)$$</p><p>$$ {\bf{k}}_1 = {\bf{F(x }}_n,t ) \quad(12)$$
$$ {\bf{k}}_2 = {\bf{F(x }}_n + (h/2){\bf{k}}_1 ,t+h/2)\quad(13) $$
$$ {\bf{k}}_3 = {\bf{F(x }}_n + (h/2){\bf{k}}_2,t+h/2)\quad(14) $$
$$ {\bf{k}}_4 = {\bf{F(x }}_n + h{\bf{k}}_3,t+h)\quad(15) $$</p><p>Where \( h \) is the integration step. This is a fourth order method and it requires to evaluate the function \( \bf{F} \) four times per iteration. In this case: $$ {\bf{x}} = (x, y, z, \dot{x}, \dot{y},\dot{z}) \quad(16)$$</p><p>And the Function \( \bf{F} \):
$${\bf{F}} = (\dot{x},\dot{y},\dot{z},\ddot{x},\ddot{y},\dot{z})\quad(17) $$ where the last three entries are given by \( (8)-(10) \).</p><p>With everything defined then it is very simple to write a program to solve the problem as long as we know the partial derivatives of the constraint. This is where automatic differentiation shines!.</p></div><h1 class="relative group">Automatic differentiation.<div id=automatic-differentiation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#automatic-differentiation aria-label=Anchor>#</a></span></h1><div style=text-align:justify><p>The numerical solution of optimization problems is required everywhere, as its is a fundamental component to machine learning and A.I. implementations. Accordingly, the availability of tools which automate the task of computing gradients has also evolved and are now available in a number of frameworks, such as <b>JAX</b> and <b>Pytorch</b> for the python language. In what follows I will be using <a href=https://github.com/HIPS/autograd target=_blank>Autograd</a>, as it is well mantained, documented and offers the versatility of using <b>numpy</b> and can be readily used in <b>webassembly</b> projects.</p></div><h2 class="relative group">Enter Autograd.<div id=enter-autograd class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enter-autograd aria-label=Anchor>#</a></span></h2><p>Let us consider a set of functions which depend of \( {(x,y)} \) and a couple of parameters \( {(A,B).} \ \ \) For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>plane</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>b</span><span class=o>*</span><span class=n>y</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>paraboloid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>b</span><span class=o>*</span><span class=n>y</span><span class=o>*</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>wave</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mf>0.2</span><span class=o>*</span><span class=p>(</span><span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=o>+</span><span class=n>y</span><span class=o>*</span><span class=n>y</span><span class=p>)</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=o>+</span><span class=n>b</span><span class=o>*</span><span class=n>y</span><span class=o>*</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><p>Then it is easy to write down the function \( \bf{F} \) in \( (17) \) as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>kn</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=n>pars</span><span class=p>,</span><span class=k>case</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>pars</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>pars</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>case</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;plane&#39;</span><span class=p>,</span><span class=s1>&#39;paraboloid&#39;</span><span class=p>,</span><span class=s1>&#39;wave&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=k>case</span> <span class=o>==</span> <span class=s1>&#39;plane&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>fn</span> <span class=o>=</span> <span class=n>plane</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=k>case</span> <span class=o>==</span> <span class=s1>&#39;paraboloid&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>fn</span> <span class=o>=</span> <span class=n>paraboloid</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=k>case</span> <span class=o>==</span> <span class=s1>&#39;wave&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>fn</span> <span class=o>=</span> <span class=n>wave</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span> <span class=n>y</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span> <span class=n>z</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>vx</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span> <span class=n>vy</span> <span class=o>=</span><span class=n>r</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span> <span class=n>vz</span><span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>fx</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>2</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fy</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>3</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>dg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>fx</span><span class=p>,</span><span class=n>fy</span><span class=p>,</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>dg2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>dg</span><span class=p>,</span><span class=n>dg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>fxx</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span><span class=mi>2</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fyy</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>3</span><span class=p>),</span><span class=mi>3</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fxy</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span><span class=mi>3</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fyx</span> <span class=o>=</span> <span class=n>grad</span><span class=p>(</span><span class=n>grad</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span><span class=mi>3</span><span class=p>),</span><span class=mi>2</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ddg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>fxx</span><span class=o>*</span><span class=n>vx</span><span class=o>*</span><span class=n>vx</span><span class=p>,</span><span class=n>fyy</span><span class=o>*</span><span class=n>vy</span><span class=o>*</span><span class=n>vy</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>vx</span><span class=o>*</span><span class=n>vy</span><span class=o>*</span><span class=p>(</span><span class=n>fxy</span><span class=o>+</span><span class=n>fyx</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>        <span class=n>Num</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>ddg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>Den</span> <span class=o>=</span> <span class=n>dg2</span>
</span></span><span class=line><span class=cl>        <span class=n>A</span> <span class=o>=</span> <span class=n>Num</span><span class=o>/</span><span class=n>dg2</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>F</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>vx</span><span class=p>,</span><span class=n>vy</span><span class=p>,</span><span class=n>vz</span><span class=p>,</span><span class=o>-</span><span class=n>A</span><span class=o>*</span><span class=n>fx</span><span class=p>,</span><span class=o>-</span><span class=n>A</span><span class=o>*</span><span class=n>fy</span><span class=p>,</span><span class=o>-</span><span class=n>g</span><span class=o>+</span><span class=n>A</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>F</span>
</span></span></code></pre></div><div style=text-align:justify><p>The function objects depend of four variables, the two parameters \(a,b \) and the coordinates \( x,y \). To obtain the partial derivatives with respect to the variables we want, <code>grad</code> takes the index of the variable defined in the function. In the cases above \( x \) and \( y \) correspond to the second and third indices. Then, the required derivatives are simply computed as:</p></div><pre tabindex=0><code>fx = grad(fn,2)(a,b,x,y)
fy = grad(fn,3)(a,b,x,y)

fxx = grad(grad(fn,2),2)(a,b,x,y)
fyy = grad(grad(fn,3),3)(a,b,x,y)

fxy = grad(grad(fn,2),3)(a,b,x,y)
fyx = grad(grad(fn,3),2)(a,b,x,y)
</code></pre><p>And the Runge-Kutta loop as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>RK</span><span class=p>(</span><span class=n>tf</span><span class=p>,</span><span class=n>ro</span><span class=p>,</span><span class=k>case</span><span class=p>,</span><span class=n>h</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>dtp</span> <span class=o>=</span> <span class=mf>1e-3</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>ro</span>
</span></span><span class=line><span class=cl>    <span class=n>prm</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>t</span><span class=o>&lt;</span><span class=n>tf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>k1</span> <span class=o>=</span> <span class=n>kn</span><span class=p>(</span><span class=n>u</span><span class=p>,</span><span class=n>prm</span><span class=p>,</span><span class=k>case</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>k2</span> <span class=o>=</span> <span class=n>kn</span><span class=p>(</span><span class=n>u</span><span class=o>+</span><span class=mf>0.5</span><span class=o>*</span><span class=n>h</span><span class=o>*</span><span class=n>k1</span><span class=p>,</span><span class=n>prm</span><span class=p>,</span><span class=k>case</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>k3</span> <span class=o>=</span> <span class=n>kn</span><span class=p>(</span><span class=n>u</span><span class=o>+</span><span class=mf>0.5</span><span class=o>*</span><span class=n>h</span><span class=o>*</span><span class=n>k2</span><span class=p>,</span><span class=n>prm</span><span class=p>,</span><span class=k>case</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>k4</span> <span class=o>=</span> <span class=n>kn</span><span class=p>(</span><span class=n>u</span><span class=o>+</span><span class=n>h</span><span class=o>*</span><span class=n>k3</span><span class=p>,</span><span class=n>prm</span><span class=p>,</span><span class=k>case</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>=</span> <span class=n>u</span><span class=o>+</span> <span class=p>(</span><span class=n>h</span><span class=o>/</span><span class=mf>6.0</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>k1</span><span class=o>+</span><span class=mi>2</span><span class=o>*</span><span class=n>k2</span><span class=o>+</span><span class=mi>2</span><span class=o>*</span><span class=n>k3</span><span class=o>+</span><span class=n>k4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span><span class=o>+=</span><span class=n>h</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>u</span>
</span></span></code></pre></div><h3 class="relative group">Webassembly Implementation.<div id=webassembly-implementation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#webassembly-implementation aria-label=Anchor>#</a></span></h3><div style=text-align:justify>This project was made with the excuse of developing the numerical work and the visualisation independently, and being able to share it on the blog, taking advantage of the lovely threejs library. To achieve this, the set of functions in a given file, can be accessed by the javascript scope as follows:</div><ol><li>Import the Pyodide javascript module in the head of your document:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;https://cdn.jsdelivr.net/pyodide/v0.27.5/full/pyodide.js&#34;</span><span class=o>&gt;&lt;</span><span class=err>/script&gt;</span>
</span></span></code></pre></div><ol start=2><li>If the numerical methods are located all in a file named, lets say, &ldquo;integrals.py&rdquo;. Then, the methods are made accessible to javascript in the initialisation part with something like this:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>//Load Pyodide and install the autograd package.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>pyodideRuntime</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>loadPyodide</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>await</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>loadPackage</span><span class=p>(</span><span class=s2>&#34;micropip&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>micropip</span> <span class=o>=</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>pyimport</span><span class=p>(</span><span class=s2>&#34;micropip&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>await</span> <span class=nx>micropip</span><span class=p>.</span><span class=nx>install</span><span class=p>(</span><span class=s2>&#34;autograd&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Access the methods in &#34;integrals.py&#34;.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>runPython</span><span class=p>(</span><span class=kr>await</span> <span class=p>(</span><span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;integrals.py&#34;</span><span class=p>)).</span><span class=nx>text</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Registers the functions used in the three.js script. These can now be used as any JS function.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>pyparaboloid</span> <span class=o>=</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>globals</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;paraboloid&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>pyplane</span> <span class=o>=</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>globals</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;plane&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>pywave</span> <span class=o>=</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>globals</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;wave&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>RK</span> <span class=o>=</span> <span class=nx>pyodideRuntime</span><span class=p>.</span><span class=nx>globals</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;RK&#39;</span><span class=p>);</span>
</span></span></code></pre></div><div style=text-align : center>That is all for now! The repository with the code to integrate, as well at the code to pu the simulation on line is available <a href=https://github.com/calugo/Lagrange-Multipliers-with-autodiff/tree/main target=_blank>here</a>. The live demo can be found <a href=https://github.com/calugo/Lagrange-Multipliers-with-autodiff>here</a>.<p>Until next time!</p></div></div></div><script>var oid="views_posts/Constraints in Mechanics and automatic differentiation./index.md",oid_likes="likes_posts/Constraints in Mechanics and automatic differentiation./index.md"</script><script type=text/javascript src=/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/Python%20in%20the%20browser%20-%20Evolving%20networks/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Python in the browser: Evolving Networks.</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"></span></span></a></span><span></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title>Categories</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Carlos A. Lugo Ph.D.</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer></div></body></html>