[{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/","section":"Carlos's Website","summary":"","title":"Carlos's Website","type":"page"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/tags/data-visualization/","section":"Tags","summary":"","title":"Data Visualization","type":"tags"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/tags/feature-extraction/","section":"Tags","summary":"","title":"Feature Extraction","type":"tags"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/tags/image-analysis/","section":"Tags","summary":"","title":"Image Analysis","type":"tags"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/tags/microtubules/","section":"Tags","summary":"","title":"Microtubules","type":"tags"},{"content":" A very important part of carrying out computer simulations of a system is to provide the models with as much relevant known information of the real system. In this way we have one less parameter to worry about when studying the possible scenarios which the system can undergo, as well as to keep the simulations withing feasible biological, physiological or mechanical limits. If the final objective is to publish the results of your work in a peer reviewed journal, you are probably aware that the process of organising, writing, submitting and eventually see your efforts published is always a very slow. Moreover, as a theoretician, publishing in life sciences journals often result in very low exposure, and many of the work done always ends up relegated to appendices, supplemental sections or even excluded from the final article, which often ends up having as any authors as a footbal team!. These are the reasons behind this post, i.e. to put forward some small and fun analysis and results which might or might not end in an article, but I think are good to share with anybody interested.\nActivity in Biology - The plant cell cortex. # First, let me introduce the system under study, namely, the plant cell cortex and the cytoskeleton. Extracting the length and amount of polymer using python. # Pre-requisites. # I use the following libraries for gemtery and to load the tiff stacks.\nShapely - Gorgoeous geometry package.\nScikit-image - A very well supported and handly image processing library.\nI use Pyvista for the 3d renderings but as you will see, it is entirely optional.\nAlso numpy, matplotlib and pandas for array manipulation, plots and data processing are required.\nStep 1 - Segment the cell of interest. # In the analysis of the movies I choose only the cell which is at the center of the movie. By selecting a small set of points outlining the shape of the cell, it is possible to divide the image in inner points and outer points using any basic geometry library or if you enjoy using another program such as FIJI/ImageJ please do it by all means!. In my case I used a variant of a point picker I wrote ages ago to annotate microtubule collisions.\nThe set of points require to be ordered and the first and last points to be the same, in this way the polygonal line is closed. I read the points from an external file. Once the points are loaded in any way you prefer, then we load the tiff data file. For this purpose I use scikit-image.\nimport skimage.io as io import matplotlib.pyplot as plt import numpy as np import pyvista as pv import pandas as pd import glob as glob from shapely.geometry import Polygon, Point All the modules required for this post to work. If the movie stack file is named cortex.tiff then to import it we invoke:\nfile = \u0026#39;cortex.tiff\u0026#39;; Z = io.imread(file); And that's that! the stack is loaded into a numpy array. By using `Z.shape`, we can obtain information about the movie. In my case `print(Z.shape)` returns the tuple `(200, 512, 512)` which tells us that there are 200 frames, each frame containing a 512x512 array image. Once the points are loaded and the arrays are loaded we can mask each frame by setting everything outside the region of interest to zero and keep the inside pixels unaltered.\nStep I. Region of interest segmentation. Straightforward, yet essential. The figure above shows a masked frame, this needs to be applied to every frame. In order to apply the mask with the present approach we need to apply something like:\ncoords=[(i,j) for i,j in zip(list(X),list(Y))] pl = Polygon(coords) minx, miny, maxx, maxy = pl.bounds minx, miny, maxx, maxy = int(minx), int(miny), int(maxx), int(maxy) box_patch = [[x,y] for x in range(minx,maxx) for y in range(miny,maxy)] pixels = [] for pb in box_patch: pt = Point(pb[0],pb[1]) if(pl.contains(pt)): pixels.append([int(pb[0]), int(pb[1])]) The above snippet computes all the pixels inside the shapely polygon object. This is of course assuming the polygon point coordinates are stored in the arrays X and Y. Then, to get the masked array:\nA = Z[n,:,:] B = np.zeros(B.shape) for pix in pixels: B[pix[1],pix[0]]=A[pix[1],pix[0]] Before discussing step 2. It is worth noticing a feature of shapely. By calling pl.area, we get the value of the area enclosed by the polygon, which we will use later to compute the desired length and amount polymer estimates. So far, we have been using pixel units. To translate any results to actual length units, we need the scale conversion factor from the file metadata.\nStep 2 - Background estimation and removal. # Once we have masked all the frames in the stack, is now easy to estimate the background bias in the data. By this I mean the following. We have a stack of images showing the flourescent signal bounded to tubulin. This means the more tubulin, the more intense the signal. If we assume that the amount of actual tubulin is related to the flourescent signal by a linear relatiionship of the form: \\(\\ T_r = \\alpha F_r + \\beta_r \\) for every pixel \\(r\\) in the frame, we need to estimate the values of \\( \\alpha \\) and \\( \\beta \\) to obtain the estimates we need.\nTo estimate the background \\( \\beta \\) it is very easy to interpret the masked image as a surface \\( f(r)\\) in which the level set \\( f = c_j \\) with the more elements, is precisely the background. Again, taking advantage of numpy, we can actually compute the number of pixles with a value equal to a constant \\( c_j \\) using simple array operations as follows:\n# A: masked array B = A.ravel(); B1 = B[B\u0026gt;0.0]; bmin = min(B1); bmax = max(B1); c = list(range(bmin,bmax+1)) cn = [] for cj in c: nj = B1[B1 == cj]; cn.append(len(nj)) Applying that snippet to every masked frame, collecting every c and cn arrays, we can plot the results and we get something like:\n(Left) Counts of the number of elements on each level set of the masked frames, for every frame. The red plots correspond to the respective smoothed signals using a sliding window, the black lines correspond to the maximum value of each smoothed plot. (Right) The smoothed signals, without the raw level set counts, alongside the set which the maximal numberf of elements (the background). From the plots above it es easy to set the background value as the average of values in which the plots are maximised. In this case it give a signal value of around 5100.\nWe now need to calibrate the results by obtaining the value of \\( \\alpha \\).\nStep 3 - Tubulin/Intensity estimation. # Useful tools. # Microtubule Picker - Used in step 1 ImageJ/FIJI - Used in step 1\nShapely - Geometry package\nScikit-image - General image processing library\n","date":"27 December 2024","externalUrl":null,"permalink":"/posts/microtubules---cortical-networks-feature-extraction./","section":"Posts","summary":"","title":"Microtubules! - Cortical networks feature extraction.","type":"posts"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"27 December 2024","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":" Studying molecular evolution presents a lot of opportunities to venture into interesting side quests, such as the content of this post. Here, I showcase ways to visualise complex networks with some degree of interactivity.\nThese little renderings were conceived for lectures, talks and videos and rarely make their way into an academic publication, despite their didactic value. The reason is very simple, publications are a two dimensional, almost static version of media. However, technologies such as Jupyter, WebGL and other rendering backend libraries have been available for a long time now, and their corresponding api\u0026rsquo;s made very easy to use for everybody.\nFor the sake of brevity, let's cut to the case, here I am going through how and why I made renderings such as the ones below and what exactly these represent. Viewer I. # The genetic code mutation network, which is the example used for this post. It should work on most devices, but for a full session of fun, try it with a mouse on a separate tab. The recommended way to play with the viewer, is on single window, which can be accessed here and a legacy version with draggable nodes here\nWhat is this network? : The genetic code. # For theoreticians, molecular evolution is often a problem to become familiar with stochastic processes, as mutation and recombination of sequences which generate new genetic variants in DNA and RNA are probabilistic. On its simplest form at least, the theory is also the prefect segway to understand the origin of important features present in living systems, such as the concepts of robustness of phenotypes to perturbations of the genotype as well as evolvability or the origin of the great variability observed in the phenotypes.\nThese evolutionary features are also somewhat universal, and these are observed in systems of very different scale and nature, such as molecules, gene-regulation circuits and networks and metabolic networks.\nBoth, robustness and evolvability are linked to the topology of the neutral genotype networks, which are defined by all the possible genotypes as nodes and linked if these are a mutation away.\nTake for instance the following table containing the genetic code:\nGenetic code Phe UUU Ser UCU Tyr UAU Cys UGU Phe UUC Ser UCC Tyr UAC Cys UGC Leu UUA Ser UCA Stp UAA Stp UGA Leu UUG Ser UCG Stp UAG Trp UGG Leu CUU Pro CCU His CAU Arg CGU Leu CUC Pro CCC His CAC Arg CGC Leu CUA Pro CCA Gln CAA Arg CGA Leu CUG Pro CCG Gln CAG Arg CGG Ile AUU Thr ACU Asn AAU Ser AGU Ile AUC Thr ACC Asn AAC Ser AGC Ile AUA Thr ACA Lys AAA Arg AGA Met AUG Thr ACG Lys AAG Arg AGG Val GUU Ala GCU Asp GAU Gly GGU Val GUC Ala GCC Asp GAC Gly GGC Val GUA Ala GCA Glu GAA Gly GGA Val GUG Ala GCG Glu GAG Gly GGG Each cell contains, on the left, the aminoacid (phenotype) associated with the codon sequence (genotype) on the right. In general for an alphabet of four characters like \\( \\{U,G,A,C\\} \\) there are \\( 4^L \\) unique sequences of length \\( L \\). Each one with \\( 3 L\\) neighbour sequences one character away from it. Using this and grouping the codons by aminoacid we get the following plot.\nThe genetic code network. Click me. Although (to my taste) the graph is very pretty, it is very difficult to get any any useful information easily. However if we remove all the links from one phenotype to another, keeping just the mutation links within the same aminoacid (synonymous mutations) it is immediate to see what it is meant by robustness, as all cases with more than a single codon, posses mutations which leave the phenotype unchanged. The genetic code network II - Synonymous components. Click me. Now, the most important bit. Evolvability and how is it reflected in these diagrams. By choosing an aminoacid and plotting only the links from its nodes to the rest of the system, we can see how easy is to navigate the network from one aminoacid to all the other ones by only a few mutations, specially for those phenotypes with the largest number of codons.\nAlanine, Arginine and Asparagine networks. Click on them! Aspartic acid, Cysteine and Glutamine networks. Click on them! Glutamine acid, Glycine and Histidine networks. Click on them! Isoleucine, Leucine and Lysine networks. Click on them! Methionine, Penylalanine and Proline networks. Click on them! Serine, Stop and Threonine networks. Click on them! Tryptophan, Tyrosin and Valine networks. Click on them! As we can see from these awesome plots (to my taste) even this simple system contains enough complexity to make the graphical representation of the main ideas quite convoluted. For comparison purposes and fun, all the information so far presented is shown in the same form in the viewer already presented at the beginning of this entry, and also, in the same format as the plots above, in the following renderer.\nViewer II. # The genetic code mutation network and its components. This should work on most devices, but for a full session of fun, try it with a mouse on a separate tab. (Link here!) Final comments. # The properties of resultant graph or phenotype landscape allow us to treat the problem of evolution as problem of navigating in a complex network. This is a problem suitable to be treated with tools of statistical physics. If we posses the knowledge of a well defined genotype-phenotype mapping. This is of course a condition not easily satisfied in the vast majority of real systems. However, the theoretical framework is fairly universal. As an example of this, the plot below shows the case of of the connections between two secondary structures for the case of RNA sequences of length 12. For relatively short lengths, the secondary structure can be considered as a good approximation or proxy for the genotype-phenotype mapping. Detail of the connections between two RNA secondary structures of length 12. Showing all the sequences which fold into such structures and connected to other sequences if these are one mutation away. Again, we can see that it is possible to mutate inside and outside the secondary structures, the folding temperature for this structures is T=27 C. Finally, these are links for the repository containing the code, as well as for the viewers.\nGithub repository.\nViewer I.\nViewer II.\nLegacy viewer with draggable nodes.\n","date":"11 December 2024","externalUrl":null,"permalink":"/posts/the-genetic-code-network/","section":"Posts","summary":"","title":"Interactive network visualisation - The Genetic Code","type":"posts"},{"content":"","date":"11 December 2024","externalUrl":null,"permalink":"/tags/molecular-evolution/","section":"Tags","summary":"","title":"Molecular Evolution","type":"tags"},{"content":"","date":"11 December 2024","externalUrl":null,"permalink":"/tags/networks/","section":"Tags","summary":"","title":"Networks","type":"tags"},{"content":"","date":"11 December 2024","externalUrl":null,"permalink":"/tags/threejs/","section":"Tags","summary":"","title":"Three,js","type":"tags"},{"content":"","date":"11 December 2024","externalUrl":null,"permalink":"/tags/two.js/","section":"Tags","summary":"","title":"Two.js","type":"tags"},{"content":" Hello and welcome! My name is Carlos, I am a theoretical physicist interested in the application of physics, mathematics and computers to the study and solution of problems arising in the area of complex systems. By combining data, mathematics, physics we can write down mathematical and physical models to describe how systems composed by many interacting elements evolve in time and space. To understand how a system works, make predictions and forecast all the possible scenarios which a system can undergo, as well as the response to perturbations, treatments and interventions, we often require to numerically solve the models. These are two of my areas of expertise. I have carried out research in the formation and evolution of ecosystems, molecular evolution, the origin of cardiac arrhythmias in the human heart, pattern development in petals and chemo-mechanics of the plant cell cortex, to mention some.\nThe tools employed in such works can be broadly classified in two categories, Numerical and Theoretical.\nThe theoretical approaches include applications of the theory of dynamical systems and non-linear dynamics, chemical kinetics, game theory, mechanics and elasticity , population genetics and population dynamics, the theory of excitable systems and complex networks as useful conceptual frameworks. And statistical learning and inference to quantify the results.\nThe numerical aspect involves the solution of the equations involved in the simulations of the systems under study, which might consist of the development of optimizations schemes used in the finite element method for solving PDEs, explicit and implicit schemes to solve ODEs, Monte-Carlo methods for stochastic simulations. All these techniques, require the development and deployment of such schemes in a computer.\nAlongside the above two categories, I have developed a very strong interest in data visualization, data analysis, interactive simulations, and automation of physical computing devices and sensors for data collection, outreach demonstrations and experiments. Basically, every now and then I build robots and machines to do something fun, and at a very very very low cost .\nMany of the projects I have worked in are described here, the codes and detailed instructions are archived and documented in my github , gitlab and Hackster pages.\n","date":"10 December 2024","externalUrl":null,"permalink":"/about/bio/","section":"Abouts","summary":"","title":"About me","type":"about"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/about-me/","section":"Tags","summary":"","title":"About Me","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/about/","section":"Abouts","summary":"","title":"Abouts","type":"about"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/ai/","section":"Tags","summary":"","title":"AI","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/barcelona/","section":"Tags","summary":"","title":"Barcelona","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/cambridge/","section":"Tags","summary":"","title":"Cambridge","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/experience/","section":"Experiences","summary":"","title":"Experiences","type":"experience"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/madrid/","section":"Tags","summary":"","title":"Madrid","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/mathematical-modelling/","section":"Tags","summary":"","title":"Mathematical Modelling","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/numerical-solutions/","section":"Tags","summary":"","title":"Numerical Solutions","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/optimisation/","section":"Tags","summary":"","title":"Optimisation","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/physics/","section":"Tags","summary":"","title":"Physics","type":"tags"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/programming/","section":"Tags","summary":"","title":"Programming","type":"tags"},{"content":" Hello Everyone! and welcome to my humble corner of the digital world. My name is Carlos, I am a Cambridge U.K. based physicist, and in this site I post content related to my scientific interests and some fun things I ended up working on and I would like to share. Below, I list a few of the academic and professional positions I have hold so far. A detailed list can be found in my ORCID and Linkedin profiles.\nI got my degree from UNAM in Mexico City, working on stochastic models of city-size distributions in space and time.\nI got my PhD from the University of Manchester in the U.K. under the supervision of Prof. Alan J. McKane. There, I worked on evolution of food-web structures and stochastic population dynamics in space and time.\nUniversitat Politècnica de Catalunya (Barcelona, Spain) Applied Physics Department, working with Prof. Blas Echeberria. During this post, I worked on detailed mathematical models and numerical simulations of calcium cycling in human atrial cells and the origin of cardiac arrhythmias.\nCentro de Astrobiología, CSIC-INTA (Madrid, Spain). As part Prof. Susanna Manrubia’s research group I carried out research related to the topology induced in the space of phenotypes by genotype-phenotype mappings for the case of RNA molecules.\nUniversity of Cambridge - Department of Plant Sciences (Cambridge U.K). As part of Prof. Beverley Glover\u0026rsquo;s Evolution and Development group, I worked on the mechanical origins of petal epidermal cells patterns.\nUniversity of Cambridge - Sainsbury Laboratory (Cambridge U.K.). Here working with Francois Nèdelec, I carried out investigations of the dynamical origins of order-disorder transitions in the organization of the filaments composing the plant cortex.\nIn all these posts, my duties consist of finding the mechanisms underlying a certain phenomena, this is carried out by the application of the scientific method to postulate a set of hypothesis, abstract these hypothesis into mathematical models, then solve the models and study the solutions to make predictions. I have also carried out work on Bioinformatics at TSL in Norwich U.K. and as a scientific programmer at The European Bioinformatics Institute (EMBL-EBI) in Cambridge. In my spare time I work on robots, data visualisation, computer vision, AI and automation.\n","date":"10 December 2024","externalUrl":null,"permalink":"/experience/resume/","section":"Experiences","summary":"","title":"Resume","type":"experience"},{"content":"","date":"10 December 2024","externalUrl":null,"permalink":"/tags/work-experience/","section":"Tags","summary":"","title":"Work-Experience","type":"tags"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]